<!-- mini_insta /show_profiles.html 
# File: show_profiles.html 
# Author: Luisa Vazquez Usabiaga (lvu@bu.edu), 09/25/2025
# Description: indiviual profile for the app mini_insta
-->

{% extends 'mini_insta/base.html'%}
{% load static %}

{% block content %}


<main class="profile-page">
    <!-- created a new class so that my user interface looked cute -->
    <section class="profile-header"> 
        <div> 
            <h1>{{profile.username}}</h1>
            <h3>by {{profile.display_name}}</h3>
            <h3> {{profile.bio_text}}  </h3>

            <p> Joined {{profile.join_date}} </p>

            <!-- display the followers/followed-->
            <div class="profile-stats">
                <a href="{% url 'show_followers' profile.pk %}">
                    <div class="stat-box">
                        <h2>{{ profile.get_num_followers }}</h2>
                        <p>followers</p>
                    </div>
                </a>
            
                <a href="{% url 'show_following' profile.pk %}">
                    <div class="stat-box">
                        <h2>{{ profile.get_num_following }}</h2>
                        <p>following</p>
                    </div>
                </a>
            </div>


        </div>

        <img src="{{ profile.profile_image_url }}" alt="Profile image" class="profile-pic">

        <div>
            <a href="{% url 'update_profile' profile.pk %}">
                <button type="button">Update Profile</button>
            </a>
        </div>

    </section>
<!-- From the examples A 4 
         Display the comments abbout this article 
        {% for comment in profile.get_all_comments %}
            <div>
                <strong>by {{comment.username}} at {{comment.published}}</strong>
                <p>
                    {{comment.text}}
                </p>
            </div>
        {% endfor %} -->

    <section class="grid-container posts-grid">


        <!-- Display the posts about this profile --> 
            {% for post in profile.get_all_posts %}

                <h4>{{ post.caption }}</h4>

                <article class="post-card">
                    {% if post.get_all_photos %}
                        <!-- Show only the first photo -->
                        <a href="{% url 'post' post.pk %}">
                            {% with first_photo=post.get_all_photos.0 %}
                                {% if first_photo.image_file %}
                                    <img src="{{ first_photo.image_file.url }}" alt="Post image">
                                {% elif first_photo.image_url %}
                                    <img src="{{ first_photo.image_url }}" alt="Post image">
                                {% else %}
                                    <img src="{% static 'images/no_image.png' %}" alt="No image available">
                                {% endif %}
                            {% endwith %}
                        </a>
                        <p><em>Posted at {{ post.timestamp }}</em></p>
                    {% else %}
                        <!-- If no photo, show placeholder -->
                        <a href="{% url 'post' post.pk %}">
                            <img src="{% static 'images/no_image.png' %}" alt="No image available">
                        </a>
                        <p><em>Posted at {{ post.timestamp }}</em></p>
                </article>
                    {% endif %}
                
            {% endfor %}

    </section>
</main>  

{% endblock %} 