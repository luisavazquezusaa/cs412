<!-- voter_analytics/show_all_voters.html 
# File: show_all_voters.html  
# Author: Luisa Vazquez Usabiaga (lvu@bu.edu), 10/29/2025
# Description: shows detail information for a voter
-->

{% extends 'voter_analytics/base.html' %}
{% block content %}
<div class="container">
  <h1>Showing All Voters</h1>

  <form method="get">
    <label for="party">Party Affiliation:</label>
    <select name="party" id="party">
      <option value="">Any</option>
      {% for code in party_list %}
        <option value="{{ code }}" {% if request.GET.party == code %}selected{% endif %}>{{ code }}</option>
      {% endfor %}
    </select>

    <label for="min_year">Minimum Birth Year:</label>
    <select name="min_year" id="min_year">
      <option value="">Any</option>
      {% for year in year_list %}
        <option value="{{ year }}" {% if request.GET.min_year == year|stringformat:"s" %}selected{% endif %}>
          {{ year }}
        </option>
      {% endfor %}
    </select>

    <label for="max_year">Maximum Birth Year:</label>
    <select name="max_year" id="max_year">
      <option value="">Any</option>
      {% for year in year_list %}
        <option value="{{ year }}" {% if request.GET.max_year == year|stringformat:"s" %}selected{% endif %}>
          {{ year }}
        </option>
      {% endfor %}
    </select>

    <label for="voter_score">Voter Score:</label>
    <select name="voter_score" id="voter_score">
      <option value="">Any</option>
      {% for score in score_list %}
        <option value="{{ score }}" {% if request.GET.voter_score == score|stringformat:"s" %}selected{% endif %}>{{ score }}</option>
      {% endfor %}
    </select>

    <fieldset>
      <legend>Voted In:</legend>
      {% for election in election_list %}
        <label>
          <input type="checkbox" name="elections" value="{{ election }}"
                 {% if election in selected_elections %}checked{% endif %}>
          {{ election|upper }}
        </label>
      {% endfor %}
    </fieldset>

    <button type="submit">Filter</button>
  </form>

  <hr>

  <div class="row">
    <table>
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Street Address</th>
        <th>Date of Birth</th>
        <th>Party</th>
        <th>Voter Score</th>
      </tr>
      {% for v in voters %}
      <tr>
        <td><a href="{% url 'voter' v.pk %}">{{ v.first_name }}</a></td>
        <td><a href="{% url 'voter' v.pk %}">{{ v.last_name }}</a></td>
        <td>{{ v.address_street_number }} {{ v.address_street_name }}</td>
        <td>{{ v.date_birth }}</td>
        <td>{{ v.party }}</td>
        <td>{{ v.voter_score }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="6">No voters found for this filter.</td></tr>
      {% endfor %}
    </table>
  </div>

  <div class="pagination">
    {% if is_paginated %}
      <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
      
      {% if page_obj.has_previous %}
        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}">Previous</a>
      {% endif %}
      
      {% if page_obj.has_next %}
        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.next_page_number }}">Next</a>
      {% endif %}
    {% endif %}
  </div>
  
</div>
{% endblock %}




